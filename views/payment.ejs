<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payments Page</title>
    <link rel="stylesheet" href="/css/payment.css"> 
</head>
<body>
    <header>
        <h1>Payment Options</h1>
        <a href="/customer/order_reservation" class="back-btn">Back</a>
    </header>

    <div class="outer">
        <h2>Payment Options</h2>
        <p>To pay: <%= bill_price %></p>
    </div>
    
    <div id="mainPage" class="outer">
        <div class="box">
            <div class="payment_txt">
                <img src="/images/upi-payment-icon.svg" alt="Icon" class="icon"> 
                <b> Pay by any UPI App</b>
            </div>
            <div class="inner">
                <button class="payment-button" onclick="showUPIForm()">
                    <div class="square"> <b>+</b> </div>
                    <span class="text"> <b>Add New UPI ID</b> </span>
                </button> 
            </div>
        </div>

        <div class="box">
            <div class="payment_txt">
                <b> Credit & Debit Cards</b>
            </div>
            <div class="inner">
                <button class="payment-button" onclick="showCardForm()">
                    <div class="square"> <b>+</b> </div>
                    <span class="text"> <b>Add New Card</b> </span>
                </button> 
            </div>
        </div>

       <div class="box">
    <div class="wallet-icon-container">
        <img src="/public/images/wallet-svgrepo-com.svg" alt="Wallet Icon" class="wallet_icon">
        <b>Wallets</b>
    </div>
    <div class="inner">
        <button class="payment-button" onclick="showWallets()">
            <div class="wallet">
                
            </div>
            <span class="text"><b>Wallets</b></span>
        </button>
    </div>
</div>

    <div id="upiForm" class="payment-form outer" style="display: none;">
        <button class="back-button" onclick="goBack()">
            <img src="/images/back-svgrepo-com.svg" alt="Back">
        </button>
        <input type="text" id="upi-id" class="input_box_txt" placeholder=" ENTER UPI ID HERE">
        <button class="form-button verify-button" onclick="verifyUPI()">Verify</button>
    </div>

    <div id="cardForm" class="payment-form outer" style="display: none;">
        <button class="back-button" onclick="goBack()">
            <img src="/images/back-svgrepo-com.svg" alt="Back">
        </button>
        <div class="card_div">
            <input type="text" id="card-number" class="card_details" placeholder="Card Number">
            <div class="card-group">
                <input type="text" id="valid-thru" class="card_details" placeholder="Valid Through (MM/YY)">
                <input type="text" id="cvv" class="card_details" placeholder="CVV">
            </div>
            <input type="text" id="card-name" class="card_details" placeholder="Name on Card">
            <select id="card-type" class="card_details">
                <option value="" disabled selected>Select Card Type</option>
                <option value="debit">Debit Card</option>
                <option value="credit">Credit Card</option>
            </select>
            <button class="form-button submit-button" onclick="submitCardDetails()">Submit</button>
        </div>
    </div>
    
    <div id="walletsForm" class="payment-form outer" style="display: none;">
        <button class="back-button" onclick="goBack()">
            <img src="/images/back-svgrepo-com.svg" alt="Back">
        </button>
        <p class="select-wallet-text">Select your UPI app to proceed</p> 
        <div class="select_upi_app">
            <button class="upi_app" onclick="selectWallet('PhonePe')">
                <img src="/images/phonepe-1.svg" alt="PhonePe" class="upi-logo">
            </button>
            <button class="upi_app" onclick="selectWallet('Google Pay')">
                <img src="/images/google-pay-acceptance-mark-icon.svg" alt="Google Pay" class="upi-logo">
            </button>
            <button class="upi_app" onclick="selectWallet('Paytm')">
                <img src="/images/paytm-icon.svg" alt="Paytm" class="upi-logo">
            </button>
        </div>
    </div>

    <form action="/customer/orderplaced" method="post">
        <button type="submit">Pay</button>
    </form>

    <script>
        function showUPIForm() {
            document.getElementById('mainPage').style.display = 'none';  
            document.getElementById('upiForm').style.display = 'block';  
        }

        function showCardForm() {
            document.getElementById('mainPage').style.display = 'none';  
            document.getElementById('cardForm').style.display = 'block';  
        }

        function showWallets() {
            document.getElementById('mainPage').style.display = 'none';  
            document.getElementById('walletsForm').style.display = 'block';  
        }

        function goBack() {
            document.getElementById('mainPage').style.display = 'block';  
            document.getElementById('upiForm').style.display = 'none';  
            document.getElementById('cardForm').style.display = 'none';  
            document.getElementById('walletsForm').style.display = 'none';  
        }

        function verifyUPI() {
            let upiID = document.getElementById('upi-id').value;
            if (upiID) {
                alert('UPI ID Verified: ' + upiID);
            } else {
                alert('Please enter a valid UPI ID');
            }
        }

        function submitCardDetails() {
            let cardNumber = document.getElementById('card-number').value;
            let validThru = document.getElementById('valid-thru').value;
            let cvv = document.getElementById('cvv').value;
            let cardName = document.getElementById('card-name').value;
            let cardType = document.getElementById('card-type').value;

            let cardNumberRegex = /^\d{16}$/;  
            if (!cardNumberRegex.test(cardNumber)) {
                alert('Please enter a valid 16-digit card number');
                return; 
            }

            let validThruRegex = /^(0[1-9]|1[0-2])\/\d{2}$/;  
            if (!validThruRegex.test(validThru)) {
                alert('Please enter a valid expiration date in MM/YY format');
                return;
            }

            let [month, year] = validThru.split('/');
            month = parseInt(month, 10);
            year = parseInt(year, 10);

            if (month < 1 || month > 12 || year <= 0) {
                alert('Please enter a valid expiration date. Month should be between 01 and 12, and year should be greater than 00.');
                return;
            }

            let cvvRegex = /^\d{3}$/;  
            if (!cvvRegex.test(cvv)) {
                alert('Please enter a valid 3-digit CVV');
                return;
            }

            if (cardNumber && validThru && cvv && cardName && cardType) {
                alert('Card Details Submitted');
            } else {
                alert('Please fill all the card details');
            }
        }

        function selectWallet(walletName) {
            alert('You have selected ' + walletName);
        }
    </script>
</body>
</html>
